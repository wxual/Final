<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<script src="https://cdn.rawgit.com/riccardoscalco/textures/master/dist/textures.js" charset="utf-8"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.5/d3-legend.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"crossorigin="anonymous"></script>
<link rel="stylesheet"href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"crossorigin="anonymous">
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.4/Chart.min.js"></script>
<head>
	<nav class="navbar navbar-dark bg-dark"> 
    <a class="navbar-brand" href="#">Final Project</a>  
    <div class="form-group">
      <label class="text-white" for="sel1" >asteroid hit the water surface</label>
      <select class="form-control input-sm" id="sel1">
          <option value="0" disabled selected>Select daryName</option>
          <option value="1" onclick="v03min()">v03-dMin</option>
          <option value="2" onclick="v03max()">v03-dMax</option>
          <option value="3" onclick="v02min()">v02-dMin</option>
          <option value="4" onclick="v02max()">v02-dMax</option>
       </select>
    </div>
</nav>

	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<style>
{margin: 0;padding: 0;}

.box{
	width: 620px;
	height: 500px;
	margin: 100px auto;
	overflow: hidden;
	position: relative;
}
.content{
	width: 620px;
	height: 440px;
	overflow: hidden;
	position: relative;
}
.content div{
	position: absolute;
	top: 0;
	left: 0;
}
.content div img{
	width: 620px;
	height: 440px;
}


.control{
	width: 620px;
	height: 40px;
	background-color: #333;
	text-align: center;
}
.control-bar{
	display: inline-block;
	width: 24px;
	height: 5px;
	background: url(icon.png) no-repeat -24px -790px ;
	margin: 12px 2px 0 2px;
	cursor: pointer;
}
.control .control-bar:hover{
	background: url('icon.png') no-repeat -24px -770px;
}

.control .control-bar.current{
	background: url('icon.png') no-repeat 0 -770px;
}
#pre, #next{
	position: absolute;
	top: 50%;
	margin-top: -35px;
	width: 20px;
	height: 34px;
	background-color: pink;
	cursor: pointer;
}	
#pre{
	left: 3px;
	background:url(icon.png) no-repeat 0 0;
}
#next{
	right: 3px;
	background:url(icon.png) no-repeat -9px -45px;
}
</style>
<script>
function v03max(){
    $('#myChart').remove();
    $('#container').append('<canvas id="myChart"></canvas>');
    var c = document.getElementById('myChart')
    ctx=c.getContext('2d');
    d3.csv("ya31-v03.csv", function(error,data) {

        var max=[];
        var Timestamp=[];
        for(i=0;i<data.length;i++)
        {
            Timestamp[i]=data[i].timestamp;
            max[i]=data[i].dMax;
        }
        var myChart = new Chart(ctx, {
        type: 'line',
        data: {
        labels: Timestamp,
        datasets: [{
            label: 'dMax',
            data: max,
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            fill:false,
            pointRadius:0,
            showLine:true,
            scaleSteps : 5000,
            }]
        },
        options: {
            title: {
            display: true,
            text: 'yA31 v03 max'
            },
            animation:{                          
                duration:800 
            },
            scales: {
            yAxes: [{
                ticks: {
                max: 1.2,
                min: 0,
                stepSize: 0.3
            }}],
            xAxes: [{
                display: true,
                ticks: {
                autoSkipPadding:15
                },
                scaleLabel:{
                    display:true,
                    labelString:"timestamp"
                }}]}}});})
}
 function v02max(){
    $('#myChart').remove();
    $('#container').append('<canvas id="myChart"></canvas>');
    var c = document.getElementById('myChart')
    ctx=c.getContext('2d');
    d3.csv("ya31-v02.csv", function(error,data) {
        var max=[];
        var Timestamp=[];
        for(i=0;i<data.length;i++)
        {
            Timestamp[i]=data[i].timestamp;
            max[i]=data[i].dMax;
        }
        var myChart = new Chart(ctx, {
        type: 'line',
        data: {
        labels: Timestamp,
        datasets: [{
            label: 'dMax',
            data: max,
            backgroundColor: 'rgb(75, 192, 192)',
            borderColor: 'rgb(75, 192, 192)',
            fill:false,
            pointRadius:0,
            showLine:true,
            scaleSteps : 5000,
            }]
        },
        options: {
            title: {
            display: true,
            text: 'yA31 v02 max'
            },
            animation:{                          
                duration:800 
            },
            scales: {
            yAxes: [{
                ticks: {
                max: 1.2,
                min: 0,
                stepSize: 0.3
            }}],
            xAxes: [{
                display: true,
                ticks: {
                autoSkipPadding:15
                },
                scaleLabel:{
                    display:true,
                    labelString:"timestamp"
                }}]}}});})
}
 function v03min(){
    $('#myChart').remove();
    $('#container').append('<canvas id="myChart"></canvas>');
    var c = document.getElementById('myChart')
    ctx=c.getContext('2d');
    d3.csv("ya31-v03.csv", function(error,data) {
        var min=[];
        var Timestamp=[];
        for(i=0;i<data.length;i++){
            Timestamp[i]=data[i].timestamp;
            min[i]=data[i].dMin;
        }
      
        var myChart = new Chart(ctx, {
        type: 'line',
        data: {
        labels: Timestamp,
        datasets: [{
            label: 'dMin',
            data: min,
            backgroundColor: 'rgb(54, 162, 235)',
            borderColor: 'rgb(54, 162, 235)',
            fill:false,
            pointRadius:0,
            showLine:true,
            }]
        },
        options: {
            title: {
            display: true,
            text: 'yA31 v03 min'
            },
            animation:{                          
                duration:800 
            },
            scales: {
            yAxes: [{
                ticks: {
                    autoSkipPadding:10,
                    callback: function(value, index, values) {
                    if(value<=-10e-25){
                        a=value*1000000000000000000000000
                        return a.toFixed(1)+"e-24";
                    }
                    if(value>-10e-25&&value<0){
                        a=value*10000000000000000000000000
                        return a.toFixed(1)+"e-25";}
                    if(value==0){
                        return value;
                    }}}}],
         elements: {
            line: {
                color: "rgba(153,255,51,0.6)"// disables bezier curves
            }
        },
            xAxes: [{
                display: true,
                ticks: {
                autoSkipPadding:15,
                },
                scaleLabel:{
                    display:true,
                    labelString:"timestamp"
                }}]}}});})
}
function v02min(){
    $('#myChart').remove();
    $('#container').append('<canvas id="myChart"></canvas>');
    var c = document.getElementById('myChart')
    ctx=c.getContext('2d');
    d3.csv("ya31-v02.csv", function(error,data) {
        var min=[];
        var Timestamp=[];
        for(i=0;i<data.length;i++){
            Timestamp[i]=data[i].timestamp;
            min[i]=data[i].dMin;
        }

        var myChart = new Chart(ctx, {
        type: 'line',
        data: {
        labels: Timestamp,
        datasets: [{
            label: 'dMin',
            data: min,
            backgroundColor: 'rgb(153, 102, 255)',
            borderColor: 'rgb(153, 102, 255)',
            fill:false,
            pointRadius:1.5,
            showLine:true,
            }]
        },
        options: {
            title: {
            display: true,
            text: 'yA31 v02 min'
            },
            animation:{                          
                duration:800 
            },
            scales: {
            yAxes: [{
                ticks: {
                    autoSkipPadding:10,
                    callback: function(value, index, values) {
                    if(value<=-10e-20){
                        a=value*10000000000000000000
                        return a.toFixed(1)+"e-19";
                    }
                    if(value>-10e-20&&value<0){
                        a=value*100000000000000000000
                        return a.toFixed(1)+"e-20";}
                    if(value==0){
                        return value;
                    }}}}],
         elements: {
            line: {
                color: "rgba(153,255,51,0.6)"// disables bezier curves
            }
        },
            xAxes: [{
                display: true,
                ticks: {
                autoSkipPadding:15,
                },
                scaleLabel:{
                    display:true,
                    labelString:"timestamp"
                }}]}}});})
}

function getStyle(element, styleName){
	if(element.currentStyle){
		return element.currentStyle[styleName];
	}else{
		var computedStyle = window.getComputedStyle(element, null);
		return computedStyle[styleName];
	}
}
function animate(element,json){
	clearInterval(element.timer);
	var isStop = false;
	element.timer = setInterval(function(){
		isStop = true;
		for(var key in json){
			var current = parseInt(getStyle(element, key));
			var target = json[key];
			var step = (target - current) / 10;
			step = step > 0 ? Math.ceil(step) : Math.floor(step);
			current += step;
			if(Math.abs(target -current) > Math.abs(step)){
				isStop = false;
			}else{ 
				current = target;
			}
			element.style[key] = current + 'px';	
		}
		if(isStop){
			clearInterval(element.timer);
		}
	},10);
}

window.onload = function(){
	var box = document.getElementsByClassName('box')[0];
	var contentBox = document.getElementsByClassName('content')[0];
	var controlBox = document.getElementsByClassName('control')[0];
	var imageDivArr = contentBox.getElementsByTagName('div');

	var currentIndex = 0;
	var boxWidth = box.offsetWidth;

	for(var i= 0; i < imageDivArr.length; i++){
		var span = document.createElement('span');
		if(i == 0){
			span.className = 'control-bar current';
		}else{
			span.className = 'control-bar'; 
		}
		span.index = i;
		controlBox.appendChild(span);

		span.onclick = function(){

			if(currentIndex != this.index){

				if(this.index >　currentIndex){

					animate(imageDivArr[currentIndex],{left:-boxWidth});

					currentIndex = this.index;
					imageDivArr[currentIndex].style.left = boxWidth;

				}else{ 
					animate(imageDivArr[currentIndex],{left:boxWidth});

					currentIndex = this.index;
					imageDivArr[currentIndex].style.left = -boxWidth;
				}

				//
				animate(imageDivArr[currentIndex], {left : 0})
	
				refresh();
			}
		}
	}

	var boxWidth = box.offsetWidth;
	for(var i= 0; i < imageDivArr.length; i++){
		var imgDiv = imageDivArr[i];
		imgDiv.style.left = boxWidth + 'px';
	}
	imageDivArr[0].style.left = '0';


	function nextImage(){
		animate(imageDivArr[currentIndex],{left:-boxWidth});
	
		currentIndex++;
	
		if(currentIndex >= imageDivArr.length){
			currentIndex = 0;
		}
		imageDivArr[currentIndex].style.left = boxWidth + 'px';
	
		animate(imageDivArr[currentIndex],{left:0});
		refresh();
	}

	function prevImage(){
		animate(imageDivArr[currentIndex],{left:boxWidth}); 
	
		currentIndex--;
	
		if(currentIndex < 0){
			currentIndex = imageDivArr.length - 1;
		}
		imageDivArr[currentIndex].style.left = (-boxWidth) + 'px';
	
		animate(imageDivArr[currentIndex],{left:0});
		refresh();
	}

	function refresh(){
		for(var i = 0; i < controlBox.children.length; i++ ){
			var bar = controlBox.children[i];
			bar.className = 'control-bar'
		
		}
		controlBox.children[currentIndex].className = 'control-bar current';
	}

	document.getElementById('next').onclick = nextImage;
	document.getElementById('pre').onclick = prevImage;

	var timer = setInterval(nextImage,2000);

	box.onmouseover = function (){
		clearInterval(timer);
	}
	box.onmouseout = function (){
		timer = setInterval(nextImage ,2000);	
	}
}

</script>
</head>
<body>
	<div id="container">
  <div>
    <canvas id="myChart"></canvas>
  </div>
</div>
	<div class="box">
		<div class="content">
			<div><img src="ya31/1.png" alt="" /></div>
			<div><img src="ya31/2.png" alt="" /></div>
			<div><img src="ya31/3.png" alt="" /></div>
			<div><img src="ya31/4.png" alt="" /></div>
		</div>
		<div class="control">
			<!-- <span class="control-bar current"></span> -->
			<!-- <span class="control-bar"></span>
			<span class="control-bar"></span>
			<span class="control-bar"></span>
			<span class="control-bar"></span>
			<span class="control-bar"></span>
			<span class="control-bar"></span> -->
		</div>
		<span id="pre"></span>
		<span id="next"></span>
	</div>
</body>
</html>